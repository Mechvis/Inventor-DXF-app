<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="topic-type" content="reference-adsk">
    <meta name="helpsystempath" content="/view/INVNTOR/2026/ENU/">
    <link rel="canonical" href="/cloudhelp/2026/ENU/Inventor-API/files/FileUIEvents_OnFileInsertNewDialog.htm#!">
    <meta name="product" content="INVNTOR">
    <meta name="release" content="2026">
    <meta name="book" content="Developer">
    <meta name="component" content="Inventor-API">
    <meta name="created" content="">
    <meta name="user-comments" content="enable">
    <meta name="contextid" content="FileUIEvents_OnFileInsertNewDialog">
    <meta name="description" content="FileUIEvents.OnFileInsertNewDialog Event">
    <meta name="topicid" content="FileUIEvents_OnFileInsertNewDialog">
    <meta name="experiencelevel" content="expert">
    <meta name="audience" content="programmer">
    <meta name="language" content="ENU">
    <title>FileUIEvents.OnFileInsertNewDialog Event</title>
    <link rel="stylesheet" href="../Style/jquery-ui.css"><script src="../Scripts/jquery-1.11.1.js"></script><script src="../Scripts/jquery-ui.js"></script><link rel="stylesheet" type="text/css" href="../Style/APIHelp-chm.css">
    <link rel="stylesheet" type="text/css" href="/view/clientframework/client.css"><script type="text/javascript" src="/view/clientframework/client.js"></script><script>
          // This turns on the display of the copyright notice which is not visible by default.
          // Because the head is removed when used in the web help, this function will only exists
          // when the chm help is being created.
          window.onload = function() {
          copyrightElement = document.getElementById('CopyrightNotice');
          copyrightElement.style.display = 'block';
          };
        </script><script>
          $(function() {
          $( "#tabs" ).tabs();
          });
        </script></head>
  <body>
    <link rel="stylesheet" type="text/css" href="../Style/APIHelp.css">
    <h1 class="api">FileUIEvents.OnFileInsertNewDialog Event</h1>

          Parent Object: <a href="FileUIEvents.htm">FileUIEvents</a><br><h2 class="api">
          Description
        </h2>
    <p class="api">The OnFileInsertNewDialog event notifies the client whenever the end-user executes the Create Component command within an assembly.</p>
    <h2 class="api">
            Remarks
          </h2>By responding to this event the client can replace the 'Create In-Place Component' dialog with their own. This notification is sent to the client immediately after the command is executed but before the standard dialog is displayed to the end-user. By supplying at least the Filename argument and setting the HandlingCode to kEventHandled, Inventor will bypass displaying the standard dialog and use the information provided to create a new in-place component within the assembly. The rest of the command behavior remains the same. That is, if this isn't the first component being placed in the assembly, the end-user must select a location in the assembly to position the new component. Valid NameValueMap values for the Context parameter: 
<table border="1">
<tr>
<th>Name</th>
<th>Value</th>
<th>Comments</th>
</tr>
<tr>
<td>BOMStructure</td>
<td>BOMStructureEnum</td>
<td></td></tr>

<tr>
<td>VirtualComponent</td>
<td>Boolean</td>
<td>The <i>FileName</i> argument is the virtual component name.</td>
</tr>
<tr>
<td>ConstrainSketchPlane</td>
<td>Boolean</td>
<td>Does not apply for the first component in assembly. </td>
</tr>


</table><h2 class="api">
          Syntax
        </h2>
        
            FileUIEvents.<b>OnFileInsertNewDialog</b>( <b><i>TemplateDir</i></b> As String, <b><i>FileTypes</i></b>() As String, <b><i>DocumentObject</i></b> As <a href="Document.htm">Document</a>, <b><i>ParentHWND</i></b> As Long, <b><i>TemplateFileName</i></b> As String, <b><i>FileName</i></b> As String, <b><i>RelativeFileName</i></b> As String, <b><i>LibraryName</i></b> As String, <b><i>CustomLogicalName</i></b>() As Byte, <b><i>Context</i></b> As <a href="NameValueMap.htm">NameValueMap</a>, <b><i>HandlingCode</i></b> As <a href="HandlingCodeEnum.htm">HandlingCodeEnum</a> )
        
    <h2 class="api">
            Parameters
          </h2>
    <Table class="api-list">
      <tr class="header">
        <td class="api-list" style="width:1%;">
                Name
              </td>
        <td class="api-list" style="width:1%;">
                Type
              </td>
        <td class="api-list">
                Description
              </td>
      </tr>
      <tr>
        <td class="api-list">TemplateDir</td>
        <td class="api-list">String</td>
        <td class="api-list">The default template directory as defined in the File tab of the Application Options dialog. This information can be used by the client in their dialog to allow the end-user to select one of the standard templates.</td>
      </tr>
      <tr>
        <td class="api-list">FileTypes</td>
        <td class="api-list">String</td>
        <td class="api-list">A list of the file types displayed in the "Files of Type" combo box on the Open dialog. For example, when the Derived Component command is executed the array contains the following strings: "Part Files (*.ipt)|*.ipt" "Assembly Files (*.iam)|*.iam"</td>
      </tr>
      <tr>
        <td class="api-list">DocumentObject</td>
        <td class="api-list"><a href="Document.htm">Document</a></td>
        <td class="api-list">The AssemblyDocument object the new component will be created within.<p /></td>
      </tr>
      <tr>
        <td class="api-list">ParentHWND</td>
        <td class="api-list">Long</td>
        <td class="api-list">The Windows handle of the Inventor Application window. If the client displays their own dialog they can use this to associate their dialog to the Inventor window. This results in better behavior between the client dialog and Inventor. For example, the client window will stay on top of Inventor and if the Inventor window is collapsed the client dialog will also be collapsed.<p /></td>
      </tr>
      <tr>
        <td class="api-list">TemplateFileName</td>
        <td class="api-list">String</td>
        <td class="api-list">The full filename of the file to use as the template when creating the new component. This can be any existing file and is not restricted to the files within the default template path. If this argument is not set, then the default part or assembly template will be used for the component. The type of document is determined based on the extension of the filename supplied in the Filename argument. This argument is ignored unless the HandlingCode argument is set to kEventHandled.<p /></td>
      </tr>
      <tr>
        <td class="api-list">FileName</td>
        <td class="api-list">String</td>
        <td class="api-list">The full filename of the file to be created. When creating a component in-place, the component is created in memory and is not written to disk until the end-user performs a save of the file. Because the filename is specified during the creation of the component the end-user will not be prompted for a filename during the save operation. This argument is required if the HandlingCode is set to kEventHandled.</td>
      </tr>
      <tr>
        <td class="api-list">RelativeFileName</td>
        <td class="api-list">String</td>
        <td class="api-list">Not used.<p /></td>
      </tr>
      <tr>
        <td class="api-list">LibraryName</td>
        <td class="api-list">String</td>
        <td class="api-list">Not used.<p /></td>
      </tr>
      <tr>
        <td class="api-list">CustomLogicalName</td>
        <td class="api-list">Byte</td>
        <td class="api-list">An array of Bytes that could have been defined by an application as an additional identifier for this document.<p /></td>
      </tr>
      <tr>
        <td class="api-list">Context</td>
        <td class="api-list"><a href="NameValueMap.htm">NameValueMap</a></td>
        <td class="api-list">Input object that can be used to determine the context of why the event fired. No context information is provided for this event. See Remarks for valid NameValueMap values.<p /></td>
      </tr>
      <tr>
        <td class="api-list">HandlingCode</td>
        <td class="api-list"><a href="HandlingCodeEnum.htm">HandlingCodeEnum</a></td>
        <td class="api-list">Output that indicates how you are handling the event. This can supply any of the following three values\: * kEventNotHandled\: Inventor continues with its standard behavior and displays the "Create In&#45;Place Component" dialog to allow the end&#45;user to specify the component information. * kEventHandled\: Indicates that the client is handling getting the component information. Requires that the client also set, at least, the FileName argument with the full filename of the component to be created. * kEventCanceled\: Cancels the operation. <todo /></td>
      </tr>
    </Table>
    <h2 class="api">
            Version
          </h2>
        Introduced in version 4<br><br><div id="CopyrightNotice" style="display:none;">
      <hr>
      <table width="100%" style="font-size:15">
        <tr>
          <td align="left">
                Â© Copyright 2025 Autodesk, Inc.
              </td>
          <td align="right"><a href="mailto:mfg.api.help.comments@autodesk.com?subject=Inventor%202026%20API%20Help%20(FileUIEvents.OnFileInsertNewDialog%20Function%20Help%20Topic)">Comment on this page.</a></td>
        </tr>
      </table>
    </div>
  </body>
</html>