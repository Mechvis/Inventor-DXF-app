<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="topic-type" content="reference-adsk">
    <meta name="helpsystempath" content="/view/INVNTOR/2026/ENU/">
    <link rel="canonical" href="/cloudhelp/2026/ENU/Inventor-API/files/ApplicationEvents_OnCloseDocument.htm#!">
    <meta name="product" content="INVNTOR">
    <meta name="release" content="2026">
    <meta name="book" content="Developer">
    <meta name="component" content="Inventor-API">
    <meta name="created" content="">
    <meta name="user-comments" content="enable">
    <meta name="contextid" content="ApplicationEvents_OnCloseDocument">
    <meta name="description" content="ApplicationEvents.OnCloseDocument Event">
    <meta name="topicid" content="ApplicationEvents_OnCloseDocument">
    <meta name="experiencelevel" content="expert">
    <meta name="audience" content="programmer">
    <meta name="language" content="ENU">
    <title>ApplicationEvents.OnCloseDocument Event</title>
    <link rel="stylesheet" href="../Style/jquery-ui.css"><script src="../Scripts/jquery-1.11.1.js"></script><script src="../Scripts/jquery-ui.js"></script><link rel="stylesheet" type="text/css" href="../Style/APIHelp-chm.css">
    <link rel="stylesheet" type="text/css" href="/view/clientframework/client.css"><script type="text/javascript" src="/view/clientframework/client.js"></script><script>
          // This turns on the display of the copyright notice which is not visible by default.
          // Because the head is removed when used in the web help, this function will only exists
          // when the chm help is being created.
          window.onload = function() {
          copyrightElement = document.getElementById('CopyrightNotice');
          copyrightElement.style.display = 'block';
          };
        </script><script>
          $(function() {
          $( "#tabs" ).tabs();
          });
        </script></head>
  <body>
    <link rel="stylesheet" type="text/css" href="../Style/APIHelp.css">
    <h1 class="api">ApplicationEvents.OnCloseDocument Event</h1>

          Parent Object: <a href="ApplicationEvents.htm">ApplicationEvents</a><br><h2 class="api">
          Description
        </h2>
    <p class="api">Event that is fired whenever a document is closed.</p>
    <h2 class="api">
            Remarks
          </h2>Note : The OnOpenDocument and OnCloseDocument events fire when the document is initially opened and finally closed. This means if the file is referenced from an assembly, OnOpenDocument will not fire if a loaded file referenced in an open assembly is opened again, as internally this file is already open. Conversely, if a document is closed, the document is not really closed unless that was the final view and the document is not referenced by any other open documents. To Veto the OnCloseDocument event. When a document is about to be closed, the OnCloseDocument Application event is fired with the BeforeOrAfter argument set to kBefore. If the event handler returns HandlingCode argument set to kEventCancelled, the close operation is cancelled. Inventor then fires a corresponding kAbort event. For example: <p><Br/>
Private Sub objAppEvents_OnCloseDocument(ByVal DocumentObject As Document, ByVal FullFileName As String, ByVal BeforeOrAfter As EventTimingEnum, ByVal Context As NameValueMap, HandlingCode As HandlingCodeEnum)<Br/>
If BeforeOrAfter = kBefore Then<Br/>
Debug.Print "OnCloseDocument event vetoed"<Br/>
HandlingCode = kEventCanceled<Br/>
End If<Br/>
End Sub</p><h2 class="api">
          Syntax
        </h2>
        
            ApplicationEvents.<b>OnCloseDocument</b>( <b><i>DocumentObject</i></b> As <a href="Document.htm">Document</a>, <b><i>FullDocumentName</i></b> As String, <b><i>BeforeOrAfter</i></b> As <a href="EventTimingEnum.htm">EventTimingEnum</a>, <b><i>Context</i></b> As <a href="NameValueMap.htm">NameValueMap</a>, <b><i>HandlingCode</i></b> As <a href="HandlingCodeEnum.htm">HandlingCodeEnum</a> )
        
    <h2 class="api">
            Parameters
          </h2>
    <Table class="api-list">
      <tr class="header">
        <td class="api-list" style="width:1%;">
                Name
              </td>
        <td class="api-list" style="width:1%;">
                Type
              </td>
        <td class="api-list">
                Description
              </td>
      </tr>
      <tr>
        <td class="api-list">DocumentObject</td>
        <td class="api-list"><a href="Document.htm">Document</a></td>
        <td class="api-list">The Document object that is being closed. The document being closed is provided for both the kBefore and kAfter cases. This is because the Document is still available after it's closed, although in a limited sense, until it is terminated. One of the useful things you can do with a document in this state is to compare it's identity with a reference previously saved (usually during kBefore). For example: 

<p>
Private m_oClosingDoc As Object<Br/>
Private Sub AppEvents_OnCloseDocument(ByVal DocumentObject As Document, ByVal FullDocumentName As String, ByVal BeforeOrAfter As EventTimingEnum, ByVal Context As NameValueMap, HandlingCode As HandlingCodeEnum)<Br/>
&nbsp;&nbsp;&nbsp;If BeforeOrAfter = kBefore Then<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Check to see if the Document being closed is an interesting one.<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Interesting(DocumentObject) Then<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Save a reference to the object.<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set m_oClosingDoc = DocumentObject<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If<Br/>
&nbsp;&nbsp;&nbsp;Else<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Now we're either after the close or it's been aborted. Check to see if the document is the interesting one.<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If DocumentObject Is m_oClosingDoc Then<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If BeforeOrAfter = kAfter Then<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' The document was closed.<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ElseIf BeforeOrAfter = kAbort Then<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' The close was aborted.<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If<Br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If<Br/>
&nbsp;&nbsp;&nbsp;End If<Br/>
End Sub<Br/>
</p></td>
      </tr>
      <tr>
        <td class="api-list">FullDocumentName</td>
        <td class="api-list">String</td>
        <td class="api-list">Output string that specifies the fully qualified name of the document being closed. This is supplied both before and after.</td>
      </tr>
      <tr>
        <td class="api-list">BeforeOrAfter</td>
        <td class="api-list"><a href="EventTimingEnum.htm">EventTimingEnum</a></td>
        <td class="api-list">Input indicating if the event is being fired before (kBefore) or after (kAfter) the document is closed. Notification is sent before and after the document is closed. In the case where this event is canceled the value of this argument will be kAbort.</td>
      </tr>
      <tr>
        <td class="api-list">Context</td>
        <td class="api-list"><a href="NameValueMap.htm">NameValueMap</a></td>
        <td class="api-list">Input object that can be used to determine the context of why the event fired. This event provides additional information through the Context argument as described below: Name = "HealthStatusEnum", Value = The health status of the document. If this value is anything other than kUpToDateHealth you know the Document object returned is not in a state where you can use most of its methods or properties.</td>
      </tr>
      <tr>
        <td class="api-list">HandlingCode</td>
        <td class="api-list"><a href="HandlingCodeEnum.htm">HandlingCodeEnum</a></td>
        <td class="api-list">This event supports the ability to cancel the close. By setting this argument to kEventCanceled when the BeforeOrAfter argument is kBefore Inventor will abort the close. When the close is cancelled, this event is fired again but the BeforeOrAfter argument will have a value of kAbort.</td>
      </tr>
    </Table>
    <h2 class="api">
            Version
          </h2>
        Introduced in version 4<br><br><div id="CopyrightNotice" style="display:none;">
      <hr>
      <table width="100%" style="font-size:15">
        <tr>
          <td align="left">
                Â© Copyright 2025 Autodesk, Inc.
              </td>
          <td align="right"><a href="mailto:mfg.api.help.comments@autodesk.com?subject=Inventor%202026%20API%20Help%20(ApplicationEvents.OnCloseDocument%20Function%20Help%20Topic)">Comment on this page.</a></td>
        </tr>
      </table>
    </div>
  </body>
</html>