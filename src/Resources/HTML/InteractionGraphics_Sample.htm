<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="topic-type" content="reference-adsk">
    <meta name="helpsystempath" content="/view/INVNTOR/2026/ENU/">
    <link rel="canonical" href="/cloudhelp/2026/ENU/Inventor-API/files/InteractionGraphics_Sample.htm#!">
    <meta name="product" content="INVNTOR">
    <meta name="release" content="2026">
    <meta name="book" content="Developer">
    <meta name="component" content="Inventor-API">
    <meta name="created" content="">
    <meta name="user-comments" content="enable">
    <meta name="contextid" content="InteractionGraphics_Sample">
    <meta name="description" content="InteractionGraphics Sample">
    <meta name="topicid" content="InteractionGraphics_Sample">
    <meta name="experiencelevel" content="expert">
    <meta name="audience" content="programmer">
    <meta name="language" content="ENU">
    <title>InteractionGraphics</title>
    <link rel="stylesheet" href="../Style/jquery-ui.css"><script src="../Scripts/jquery-1.11.1.js"></script><script src="../Scripts/jquery-ui.js"></script><link rel="stylesheet" type="text/css" href="../Style/APIHelp-chm.css">
    <link rel="stylesheet" type="text/css" href="/view/clientframework/client.css"><script type="text/javascript" src="/view/clientframework/client.js"></script><script>
          // This turns on the display of the copyright notice which is not visible by default.
          // Because the head is removed when used in the web help, this function will only exists
          // when the chm help is being created.
          window.onload = function() {
          copyrightElement = document.getElementById('CopyrightNotice');
          copyrightElement.style.display = 'block';
          };
        </script><script>
          $(function() {
          $( "#tabs" ).tabs();
          });
        </script></head>
  <body><script>
          function copyCode(language) {
          // Get the pre element for the specified language.
          var preElement = document.getElementById(language);

          // Get the text from the element and copy it to the clipboard.
          var preText = preElement.innerText;

          var isIE = /*@cc_on!@*/false || !!document.documentMode;

          if (isIE)
          {
            window.clipboardData.setData('Text', preText);
          }
          else
          {
            navigator.clipboard.writeText(preText);
          }

          //alert("Code copied to clipboard");
          }
        </script><link rel="stylesheet" type="text/css" href="../Style/APIHelp.css">
    <h1 class="api">InteractionGraphics</h1>
    <h2 class="api">
          Description
        </h2>The sample creates overlay graphics.<h2 class="api">
          Code Samples
        </h2>
    <div id="tabs">
      <ul>
        <li><a href="#VBA">VBA</a></li>
        <li><a href="#iLogic">iLogic</a></li>
      </ul>
      <div id="VBA" class="api-code">Follow these steps: 1. Have a drawing document open. 2. Cut and paste in a VBA module. 3. Run the sample. Overlay graphics is created. 4. Hit the escape key to end interaction events and bring down the graphics.<table width="100%" style="font-size:15">
          <tr>
            <td align="right"><button onclick="copyCode('VBA_code')" class="copy-code">Copy Code</button></td>
          </tr>
        </table>
        <pre class="api-code" id="VBA_code">Dim oIE As InteractionEvents


Public Sub DrawOverlayGraphics()
    Dim oDoc As Document
    Set oDoc = ThisApplication.ActiveDocument

    Set oIE = ThisApplication.CommandManager.CreateInteractionEvents
    oIE.Start
    
    Dim oIG As InteractionGraphics
    Set oIG = oIE.InteractionGraphics
    
    On Error Resume Next
    Dim oDataSets As GraphicsDataSets
    Set oDataSets = oIG.GraphicsDataSets
        
    <span style="color:blue">' Set a reference to the transient geometry object for use later.</span>
    Dim oTransGeom As TransientGeometry
    Set oTransGeom = ThisApplication.TransientGeometry

    <span style="color:blue">' Create a coordinate set.</span>
    Dim oCoordSet As GraphicsCoordinateSet
    Set oCoordSet = oDataSets.CreateCoordinateSet(1)
    
    <span style="color:blue">' Create an array that contains coordinates that define a set</span>
    <span style="color:blue">' of outwardly spiraling points.</span>
    Dim oPointCoords(1 To 90) As Double
    Dim i As Long
    Dim dRadius As Double
    dRadius = 1
    Dim dAngle As Double
    For i = 0 To 29
        <span style="color:blue">' Define the X, Y, and Z components of the point.</span>
        oPointCoords(i * 3 + 1) = dRadius * Cos(dAngle)
        oPointCoords(i * 3 + 2) = dRadius * Sin(dAngle)
        oPointCoords(i * 3 + 3) = i / 2
       
        <span style="color:blue">' Increment the angle and radius to create the spiral.</span>
        dRadius = dRadius + 0.25
        dAngle = dAngle + (3.14159265358979 / 6)
    Next
   
    <span style="color:blue">' Assign the points into the coordinate set.</span>
    Call oCoordSet.PutCoordinates(oPointCoords)
   
    <span style="color:blue">' Create the ClientGraphics object.</span>
    Dim oClientGraphics As ClientGraphics
    Set oClientGraphics = oIG.OverlayClientGraphics
   
    <span style="color:blue">' Create a new graphics node within the client graphics objects.</span>
    Dim oLineNode As GraphicsNode
    Set oLineNode = oClientGraphics.AddNode(1)
   
    <span style="color:blue">' Create a LineGraphics object within the node.</span>
    Dim oLineSet As LineGraphics
    Set oLineSet = oLineNode.AddLineGraphics
   
    <span style="color:blue">' Assign the coordinate set to the line graphics.</span>
    oLineSet.CoordinateSet = oCoordSet
   
    <span style="color:blue">' Update the view to see the resulting spiral.</span>
    oIG.UpdateOverlayGraphics ThisApplication.ActiveView
   
    <span style="color:blue">' Create another graphics node for a line strip.</span>
    Dim oLineStripNode As GraphicsNode
    Set oLineStripNode = oClientGraphics.AddNode(2)
   
    <span style="color:blue">' Create a LineStripGraphics object within the new node.</span>
    Dim oLineStrip As LineStripGraphics
    Set oLineStrip = oLineStripNode.AddLineStripGraphics
   
    <span style="color:blue">' Assign the same coordinate set to the line strip.</span>
    oLineStrip.CoordinateSet = oCoordSet
   
    <span style="color:blue">' Create a color set to use in defining a explicit color to the line strip.</span>
    Dim oColorSet As GraphicsColorSet
    Set oColorSet = oDataSets.CreateColorSet(1)
   
    <span style="color:blue">' Add a single color to the set that is red.</span>
    Call oColorSet.Add(1, 255, 0, 0)
   
    <span style="color:blue">' Assign the color set to the line strip.</span>
    oLineStrip.ColorSet = oColorSet
   
    <span style="color:blue">' The two spirals are currently on top of each other so translate the</span>
    <span style="color:blue">' new one in the x direction so they're side by side.</span>
    Dim oMatrix As Matrix
    Set oMatrix = oLineStripNode.Transformation
    Call oMatrix.SetTranslation(oTransGeom.CreateVector(15, 0, 0))
    oLineStripNode.Transformation = oMatrix
   
    <span style="color:blue">' Update the view to see the resulting spiral.</span>
    oIG.UpdateOverlayGraphics ThisApplication.ActiveView
   
    <span style="color:blue">'oIE.Stop</span>
End Sub</pre>
      </div>
      <div id="iLogic" class="api-code">Follow these steps: 1. Have a drawing document open. 2. Copy the code to iLogic rule. 3. Run the sample. Overlay graphics is created. 4. Hit the escape key to end interaction events and bring down the graphics.<table width="100%" style="font-size:15">
          <tr>
            <td align="right"><button onclick="copyCode('iLogic_code')" class="copy-code">Copy Code</button></td>
          </tr>
        </table>
        <pre class="api-code" id="iLogic_code">Class Test
	Dim oIE As InteractionEvents
		
	Sub Main
	    Dim oDoc As Document
	    oDoc = ThisApplication.ActiveDocument
	
	    oIE = ThisApplication.CommandManager.CreateInteractionEvents
	    oIE.Start
	    
	    Dim oIG As InteractionGraphics
	    oIG = oIE.InteractionGraphics
	    
	    On Error Resume Next
	    Dim oDataSets As GraphicsDataSets
	    oDataSets = oIG.GraphicsDataSets
	        
	    <span style="color:blue">' Set a reference to the transient geometry object for use later.</span>
	    Dim oTransGeom As TransientGeometry
	    oTransGeom = ThisApplication.TransientGeometry
	
	    <span style="color:blue">' Create a coordinate set.</span>
	    Dim oCoordSet As GraphicsCoordinateSet
	    oCoordSet = oDataSets.CreateCoordinateSet(1)
	    
	    <span style="color:blue">' Create an array that contains coordinates that define a set</span>
	    <span style="color:blue">' of outwardly spiraling points.</span>
	    Dim oPointCoords(0 To 89) As Double
	    Dim i As Long
	    Dim dRadius As Double
	    dRadius = 1
	    Dim dAngle As Double
	    For i = 0 To 29
	        <span style="color:blue">' Define the X, Y, and Z components of the point.</span>
	        oPointCoords(i * 3) = dRadius * Cos(dAngle)
	        oPointCoords(i * 3 + 1) = dRadius * Sin(dAngle)
	        oPointCoords(i * 3 + 2) = i / 2
	       
	        <span style="color:blue">' Increment the angle and radius to create the spiral.</span>
	        dRadius = dRadius + 0.25
	        dAngle = dAngle + (3.14159265358979 / 6)
	    Next
	   
	    <span style="color:blue">' Assign the points into the coordinate set.</span>
	    Call oCoordSet.PutCoordinates(oPointCoords)
	   
	    <span style="color:blue">' Create the ClientGraphics object.</span>
	    Dim oClientGraphics As ClientGraphics
	    oClientGraphics = oIG.OverlayClientGraphics
	   
	    <span style="color:blue">' Create a new graphics node within the client graphics objects.</span>
	    Dim oLineNode As GraphicsNode
	    oLineNode = oClientGraphics.AddNode(1)
	   
	    <span style="color:blue">' Create a LineGraphics object within the node.</span>
	    Dim oLineSet As LineGraphics
	    oLineSet = oLineNode.AddLineGraphics
	   
	    <span style="color:blue">' Assign the coordinate set to the line graphics.</span>
	    oLineSet.CoordinateSet = oCoordSet
	   
	    <span style="color:blue">' Update the view to see the resulting spiral.</span>
	    oIG.UpdateOverlayGraphics(ThisApplication.ActiveView)
	   
	    <span style="color:blue">' Create another graphics node for a line strip.</span>
	    Dim oLineStripNode As GraphicsNode
	    oLineStripNode = oClientGraphics.AddNode(2)
	   
	    <span style="color:blue">' Create a LineStripGraphics object within the new node.</span>
	    Dim oLineStrip As LineStripGraphics
	    oLineStrip = oLineStripNode.AddLineStripGraphics
	   
	    <span style="color:blue">' Assign the same coordinate set to the line strip.</span>
	    oLineStrip.CoordinateSet = oCoordSet
	   
	    <span style="color:blue">' Create a color set to use in defining a explicit color to the line strip.</span>
	    Dim oColorSet As GraphicsColorSet
	    oColorSet = oDataSets.CreateColorSet(1)
	   
	    <span style="color:blue">' Add a single color to the set that is red.</span>
	    Call oColorSet.Add(1, 255, 0, 0)
	   
	    <span style="color:blue">' Assign the color set to the line strip.</span>
	    oLineStrip.ColorSet = oColorSet
	   
	    <span style="color:blue">' The two spirals are currently on top of each other so translate the</span>
	    <span style="color:blue">' new one in the x direction so they're side by side.</span>
	    Dim oMatrix As Matrix
	    oMatrix = oLineStripNode.Transformation
	    Call oMatrix.SetTranslation(oTransGeom.CreateVector(15, 0, 0))
	    oLineStripNode.Transformation = oMatrix
	   
	    <span style="color:blue">' Update the view to see the resulting spiral.</span>
	    oIG.UpdateOverlayGraphics(ThisApplication.ActiveView)
	   
	    <span style="color:blue">'oIE.Stop</span>
	End Sub
End Class</pre>
      </div>
    </div><br><br><div id="CopyrightNotice" style="display:none;">
      <hr>
      <table width="100%" style="font-size:15">
        <tr>
          <td align="left">
                Â© Copyright 2025 Autodesk, Inc.
              </td>
          <td align="right"><a href="mailto:mfg.api.help.comments@autodesk.com?subject=Inventor%202026%20API%20Help%20(InteractionGraphics%20Sample%20Help%20Topic)">Comment on this page.</a></td>
        </tr>
      </table>
    </div>
  </body>
</html>